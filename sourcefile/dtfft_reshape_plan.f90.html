<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="DataTyped Fast Fourier Transform">
    <meta name="author" content="Oleg Shatrov" >
    <link rel="icon" href="../favicon.png">

    <title>dtfft_reshape_plan.F90 &ndash; dtFFT</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">dtFFT </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/test_host_kernels.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>dtfft_reshape_plan.F90
      <small>Source File</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.5% of total for source files.">295 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dtfft_reshape_plan.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
            <li class="breadcrumb-item active" aria-current="page">dtfft_reshape_plan.F90</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#mods-0"
         aria-expanded="false" aria-controls="mods-0">
         <h4 class="card-header bg-primary text-white">Modules</h4>
      </a>
      <div id="mods-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/dtfft_reshape_plan.html">dtfft_reshape_plan</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/dtfft_reshape_plan.f90.html#src">dtfft_reshape_plan.F90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">This file depends on</h3>
          </div>
          <div class="card-body">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiledtfft_reshape_planf90EfferentGraph" width="641pt" height="618pt"
 viewBox="0.00 0.00 641.00 617.85" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph" class="graph" transform="scale(0.3 0.3) rotate(0) translate(4 2058.7)">
<title>sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2058.7 2136,-2058.7 2136,4 -4,4"/>
<!-- sourcefile~dtfft_reshape_plan.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~dtfft_reshape_plan.f90</title>
<polygon fill="none" stroke="black" points="2132,-682.5 1999,-682.5 1999,-658.5 2132,-658.5 2132,-682.5"/>
<text text-anchor="middle" x="2065.5" y="-668.1" font-family="Helvetica,sans-Serif" font-size="10.50">dtfft_reshape_plan.F90</text>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~dtfft_abstract_backend.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/dtfft_abstract_backend.f90.html" xlink:title="dtfft_abstract_backend.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1061.5,-701.5 904.5,-701.5 904.5,-677.5 1061.5,-677.5 1061.5,-701.5"/>
<text text-anchor="middle" x="983" y="-687.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_abstract_backend.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2030.34,-682.53C1991.07,-697.64 1926.33,-726.65 1882,-767.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1880,-767.5C1841.15,-803.31 1815.03,-755.67 1763,-746.5 1731.85,-741.01 1233.6,-648.19 1202,-649.5"/>
</g>
<!-- sourcefile~dtfft_abstract_reshape_handle.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dtfft_abstract_reshape_handle.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dtfft_abstract_reshape_handle.f90.html" xlink:title="dtfft_abstract_reshape_handle.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1299,-489.5 1103,-489.5 1103,-465.5 1299,-465.5 1299,-489.5"/>
<text text-anchor="middle" x="1201" y="-475.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_abstract_reshape_handle.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1665.5,-76.5C1622,-71.74 1608.33,-79.39 1570,-100.5 1497.72,-140.31 1516.75,-214.05 1435.5,-228.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.5,-228.5C1319.55,-248.78 1391.49,-381.92 1299,-451.5 1293.88,-455.35 1288.23,-458.64 1282.31,-461.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.67,-458.32 1272.82,-465.44 1283.39,-464.77 1280.67,-458.32"/>
</g>
<!-- sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~dtfft_config.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/dtfft_config.f90.html" xlink:title="dtfft_config.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="625,-849.5 530,-849.5 530,-825.5 625,-825.5 625,-849.5"/>
<text text-anchor="middle" x="577.5" y="-835.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_config.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1200,-76.5C1067.23,-95.39 1005.23,-15.65 899,-97.5 859.59,-127.87 884.78,-158.77 863,-203.5 800.04,-332.85 737.93,-340.34 686,-474.5 649.76,-568.13 681.21,-602.08 650,-697.5 635.42,-742.09 608.18,-789.92 591.86,-816.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="588.7,-815 586.38,-825.34 594.64,-818.69 588.7,-815"/>
</g>
<!-- sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dtfft_errors.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dtfft_errors.f90.html" xlink:title="dtfft_errors.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="109,-1219.5 15,-1219.5 15,-1195.5 109,-1195.5 109,-1219.5"/>
<text text-anchor="middle" x="62" y="-1205.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_errors.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-2029.5C687.38,-2019.75 665.07,-2025.34 578.5,-2029.5"/>
</g>
<!-- sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dtfft_interface_cuda_runtime.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dtfft_interface_cuda_runtime.f90.html" xlink:title="dtfft_interface_cuda_runtime.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="469,-693.5 280,-693.5 280,-669.5 469,-669.5 469,-693.5"/>
<text text-anchor="middle" x="374.5" y="-679.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_cuda_runtime.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.5,-0.5C1388.47,1.23 1375.57,-4.9 1335,-24.5 1316.75,-33.32 1317.24,-43.65 1299,-52.5 1259.04,-71.89 1245.95,-70.11 1202,-76.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1200,-76.5C967.34,-110.32 873.43,-59.58 686,-201.5 579.49,-282.15 567.16,-323.24 505,-441.5 481.46,-486.29 491.87,-504.37 469,-549.5 447.42,-592.08 413.29,-636.3 392.77,-661.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="389.84,-659.27 386.13,-669.2 395.22,-663.75 389.84,-659.27"/>
</g>
<!-- sourcefile~dtfft_interface_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dtfft_interface_nccl.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dtfft_interface_nccl.f90.html" xlink:title="dtfft_interface_nccl.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="843,-507.5 706,-507.5 706,-483.5 843,-483.5 843,-507.5"/>
<text text-anchor="middle" x="774.5" y="-493.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_nccl.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1200,-76.5C1130.81,-87.15 944.91,-116.65 899,-169.5 832.87,-245.63 905.42,-302.03 863,-393.5 847.58,-426.76 818.12,-457.62 797.67,-476.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="795.14,-474.06 790.05,-483.36 799.83,-479.27 795.14,-474.06"/>
</g>
<!-- sourcefile~dtfft_interface_nvshmem.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dtfft_interface_nvshmem.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dtfft_interface_nvshmem.f90.html" xlink:title="dtfft_interface_nvshmem.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1067,-202.5 899,-202.5 899,-178.5 1067,-178.5 1067,-202.5"/>
<text text-anchor="middle" x="983" y="-188.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_nvshmem.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_nvshmem.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_nvshmem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1665.5,-76.5C1563.89,-65.37 1535.95,-57.58 1435.5,-76.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.5,-76.5C1389.22,-84.85 1375.57,-80.9 1335,-100.5 1316.75,-109.32 1317.44,-120.1 1299,-128.5 1228.59,-160.6 1141.92,-176.11 1077.32,-183.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1076.7,-180.14 1067.15,-184.73 1077.47,-187.1 1076.7,-180.14"/>
</g>
<!-- sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dtfft_interface_nvtx.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dtfft_interface_nvtx.f90.html" xlink:title="dtfft_interface_nvtx.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5,-1523.5 305.5,-1523.5 305.5,-1499.5 443.5,-1499.5 443.5,-1523.5"/>
<text text-anchor="middle" x="374.5" y="-1509.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_nvtx.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1880,-767.5C1708.36,-927.04 1885.08,-1615.48 1763,-1815.5 1672.41,-1963.92 1603.42,-1984.39 1435.5,-2029.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.5,-2029.5C1320.54,-2049.06 604.51,-1636.43 505,-1579.5 488.31,-1569.95 485.75,-1564.96 469,-1555.5 451.07,-1545.38 430.43,-1535.49 413.11,-1527.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="414.43,-1524.42 403.87,-1523.54 411.57,-1530.81 414.43,-1524.42"/>
</g>
<!-- sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dtfft_parameters.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dtfft_parameters.f90.html" xlink:title="dtfft_parameters.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="124,-1122.5 0,-1122.5 0,-1098.5 124,-1098.5 124,-1122.5"/>
<text text-anchor="middle" x="62" y="-1108.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_parameters.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2062.33,-658.25C2049.13,-585.19 1976.89,-208.39 1882,-152.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1880,-152.5C1793.58,-101.6 1767.44,-85.06 1667.5,-76.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1665.5,-76.5C1602.88,-71.14 1593.89,-43.54 1534,-24.5 1491.06,-10.85 1480.53,-2.24 1435.5,-0.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.5,-0.5C1329.31,3.52 1303.81,-60.99 1202,-38.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1200,-38.5C974.99,11.19 898.73,-17.93 686,-106.5 630.28,-129.7 629.21,-156.76 578.5,-189.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M576.5,-189.5C545.14,-207.15 530.8,-202.42 505,-227.5 421.45,-308.74 472.89,-391.51 375.5,-455.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M373.5,-455.5C338.06,-478.79 312.23,-446.94 280,-474.5 205.41,-538.31 266.82,-606.92 203,-681.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201,-681.5C93.06,-807.63 69.25,-1019.4 64.26,-1088.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="60.76,-1088.1 63.59,-1098.31 67.74,-1088.56 60.76,-1088.1"/>
</g>
<!-- sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dtfft_pencil.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dtfft_pencil.f90.html" xlink:title="dtfft_pencil.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="821.5,-625.5 727.5,-625.5 727.5,-601.5 821.5,-601.5 821.5,-625.5"/>
<text text-anchor="middle" x="774.5" y="-611.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_pencil.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1665.5,-76.5C1563.79,-65.36 1348.89,-196.11 1335,-214.5 1279.51,-287.97 1365.56,-354.89 1299,-418.5 1247.97,-467.28 1050.95,-437.12 984,-459.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M982,-459.5C908.45,-484.47 929,-546.55 863,-587.5 853.31,-593.51 842.16,-598.2 831.14,-601.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="830.06,-598.5 821.52,-604.75 832.1,-605.19 830.06,-598.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dtfft_reshape_handle_datatype.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dtfft_reshape_handle_datatype.f90.html" xlink:title="dtfft_reshape_handle_datatype.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1534,-625.5 1335,-625.5 1335,-601.5 1534,-601.5 1534,-625.5"/>
<text text-anchor="middle" x="1434.5" y="-611.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_reshape_handle_datatype.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_reshape_handle_datatype.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_reshape_handle_datatype.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1880,-152.5C1784.09,-71.39 1511.19,-492.63 1448.46,-592.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1445.39,-590.91 1443.06,-601.24 1451.33,-594.62 1445.39,-590.91"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dtfft_reshape_handle_generic.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dtfft_reshape_handle_generic.f90.html" xlink:title="dtfft_reshape_handle_generic.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1763,-779.5 1570,-779.5 1570,-755.5 1763,-755.5 1763,-779.5"/>
<text text-anchor="middle" x="1666.5" y="-765.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_reshape_handle_generic.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_reshape_handle_generic.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_reshape_handle_generic.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1880,-767.5C1834.54,-809.4 1757.54,-796.45 1709.77,-782.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1710.63,-779.1 1700.04,-779.53 1708.58,-785.8 1710.63,-779.1"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dtfft_reshape_plan_base.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dtfft_reshape_plan_base.f90.html" xlink:title="dtfft_reshape_plan_base.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1963,-682.5 1799,-682.5 1799,-658.5 1963,-658.5 1963,-682.5"/>
<text text-anchor="middle" x="1881" y="-668.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_reshape_plan_base.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_reshape_plan_base.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_reshape_plan_base.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1998.87,-670.5C1990.57,-670.5 1981.96,-670.5 1973.36,-670.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1973.27,-667 1963.27,-670.5 1973.27,-674 1973.27,-667"/>
</g>
<!-- sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dtfft_utils.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dtfft_utils.f90.html" xlink:title="dtfft_utils.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="244,-1027.5 160,-1027.5 160,-1003.5 244,-1003.5 244,-1027.5"/>
<text text-anchor="middle" x="202" y="-1013.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_utils.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dtfft_reshape_plan.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.5,-2029.5C1145.14,-2078.19 1067.61,-2043.56 775.5,-2029.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-2029.5C650.77,-2019.47 346.98,-1880.83 280,-1777.5 237.76,-1712.34 267.74,-1153.44 244,-1079.5 238.87,-1063.53 228.72,-1047.64 219.81,-1035.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.53,-1033.48 213.62,-1027.73 217,-1037.77 222.53,-1033.48"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-729.5C735.03,-741.61 718.31,-729.37 686,-753.5 661.69,-771.66 673.55,-792.38 650,-811.5 645.34,-815.29 640.07,-818.55 634.57,-821.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="632.79,-818.32 625.15,-825.65 635.7,-824.69 632.79,-818.32"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M976.79,-701.63C961.58,-737.66 917.19,-847.56 899,-943.5 886.33,-1010.32 907.98,-1503.49 863,-1554.5 810.07,-1614.52 762.42,-1563.76 686,-1587.5 669.28,-1592.7 666.25,-1596.99 650,-1603.5 625.51,-1613.31 220.51,-1783.23 203,-1763.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201,-1763.5C177.88,-1737.85 172.67,-1729.63 160,-1697.5 92.2,-1525.59 70.06,-1300.35 64.55,-1229.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="68.04,-1229.42 63.8,-1219.71 61.06,-1229.94 68.04,-1229.42"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M941.98,-677.41C900.63,-666.12 834.05,-651.32 775.5,-653.5"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.58,-677.35C911.28,-673.84 904.5,-669.32 899,-663.5 854.25,-616.21 908.1,-568.46 863,-521.5 859.76,-518.13 856.11,-515.19 852.18,-512.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="853.63,-509.43 843.2,-507.6 850.21,-515.54 853.63,-509.43"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M978.17,-701.84C960.64,-757.97 887.87,-987.4 863,-1009.5 802.49,-1063.28 744.09,-996.12 686,-1052.5 642.67,-1094.56 692.26,-1140.38 650,-1183.5 602.95,-1231.51 548.83,-1175.54 505,-1226.5 429.22,-1314.61 545.53,-1398.04 469,-1485.5 464.45,-1490.7 458.97,-1494.9 452.95,-1498.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="451.31,-1495.19 443.82,-1502.69 454.35,-1501.5 451.31,-1495.19"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.29,-677.48C912.45,-673.95 905.07,-669.39 899,-663.5 863.9,-629.43 899.19,-592.41 863,-559.5 803.1,-505.04 764.6,-535.88 686,-516.5 651.86,-508.09 404.37,-435.43 375.5,-455.5"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M935.44,-677.47C923.31,-673.65 910.44,-668.97 899,-663.5 881.65,-655.21 880.41,-647.67 863,-639.5 853.11,-634.87 842.21,-630.84 831.55,-627.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="832.46,-624.05 821.87,-624.48 830.41,-630.75 832.46,-624.05"/>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M904.47,-700.24C865.29,-706.74 817.3,-716.35 775.5,-729.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-729.5C735.03,-741.61 724.51,-741.53 686,-753.5 604.66,-778.78 581.61,-779.26 505,-816.5 443.52,-846.39 438.97,-874.11 375.5,-899.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M373.5,-899.5C334.22,-915.47 316.15,-896.33 280,-918.5 249.82,-937.01 226.61,-971.83 213.89,-994.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="210.65,-992.96 208.94,-1003.41 216.8,-996.31 210.65,-992.96"/>
</g>
<!-- sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dtfft_abstract_kernel.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dtfft_abstract_kernel.f90.html" xlink:title="dtfft_abstract_kernel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650,-1389.5 505,-1389.5 505,-1365.5 650,-1365.5 650,-1389.5"/>
<text text-anchor="middle" x="577.5" y="-1375.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_abstract_kernel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dtfft_abstract_backend.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M977.67,-701.56C964.73,-737.83 925.57,-849.29 899,-943.5 880.27,-1009.9 906.8,-1041.2 863,-1094.5 808.08,-1161.34 745.32,-1112.53 686,-1175.5 655.61,-1207.77 670.27,-1229.09 650,-1268.5 633.34,-1300.91 609.35,-1335.66 593.85,-1357"/>
<polygon fill="#ff0000" stroke="#ff0000" points="590.87,-1355.14 587.77,-1365.27 596.51,-1359.29 590.87,-1355.14"/>
</g>
<!-- sourcefile~dtfft_abstract_reshape_handle.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dtfft_abstract_reshape_handle.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1194.78,-489.56C1179.88,-522.55 1133.88,-615.07 1067,-663.5 1061.58,-667.43 1055.54,-670.78 1049.27,-673.63"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1047.87,-670.42 1039.96,-677.46 1050.54,-676.89 1047.87,-670.42"/>
</g>
<!-- sourcefile~dtfft_abstract_reshape_handle.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dtfft_abstract_reshape_handle.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1182.98,-465.31C1158.64,-448.66 1111.87,-419.51 1067,-407.5 769.39,-327.88 629.35,-280.95 375.5,-455.5"/>
</g>
<!-- sourcefile~dtfft_abstract_reshape_handle.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dtfft_abstract_reshape_handle.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M1162.23,-465.48C1118.24,-453.47 1043.96,-439.46 984,-459.5"/>
</g>
<!-- sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M561.21,-849.66C511.65,-888.67 350.19,-1012.85 203,-1093.5"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M201,-1093.5C153.23,-1119.43 106.32,-1163.15 81.39,-1188.24"/>
<polygon fill="#ffda00" stroke="#ffda00" points="78.88,-1185.8 74.38,-1195.39 83.88,-1190.7 78.88,-1185.8"/>
</g>
<!-- sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M563.31,-825.41C543.41,-807.34 504.29,-772.55 469,-745.5 447.44,-728.97 421.92,-711.65 403,-699.2"/>
<polygon fill="#ffda00" stroke="#ffda00" points="404.83,-696.22 394.55,-693.67 401,-702.08 404.83,-696.22"/>
</g>
<!-- sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M551.21,-825.41C469.24,-786.42 215.39,-667.31 203,-681.5"/>
</g>
<!-- sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dtfft_config.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M529.86,-849.57C488.64,-860.77 427.21,-878.82 375.5,-899.5"/>
</g>
<!-- sourcefile~dtfft_interface_cuda_runtime.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dtfft_interface_cuda_runtime.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M342.31,-669.45C303.08,-656.57 236.78,-642.81 203,-681.5"/>
</g>
<!-- sourcefile~dtfft_interface_cuda_runtime.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dtfft_interface_cuda_runtime.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M299.8,-693.63C292.46,-697.17 285.64,-701.71 280,-707.5 239.64,-748.94 213.7,-929.48 205.67,-993.16"/>
<polygon fill="#48ff00" stroke="#48ff00" points="202.16,-992.96 204.41,-1003.32 209.11,-993.82 202.16,-992.96"/>
</g>
<!-- sourcefile~dtfft_interface_nccl.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dtfft_interface_nccl.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M736.94,-483.46C698.09,-471.74 634.66,-455.66 578.5,-455.5"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M576.5,-455.5C487.17,-455.24 448.84,-404.5 375.5,-455.5"/>
</g>
<!-- sourcefile~dtfft_interface_nccl.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dtfft_interface_nccl.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M576.5,-455.5C521.57,-455.34 520.45,-497.24 469,-516.5 429.29,-531.37 407.93,-508.18 375.5,-535.5"/>
</g>
<!-- sourcefile~dtfft_interface_nvshmem.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dtfft_interface_nvshmem.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M898.59,-188.86C860.98,-188.43 816,-188.37 775.5,-189.5"/>
</g>
<!-- sourcefile~dtfft_interface_nvshmem.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dtfft_interface_nvshmem.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M940.13,-202.56C849.69,-230.51 633.9,-307.76 505,-441.5 479.34,-468.12 498.17,-493.78 469,-516.5 435.55,-542.56 407.93,-508.18 375.5,-535.5"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M373.5,-535.5C321.27,-581.17 308.79,-597.38 280,-660.5 226.27,-778.31 209.2,-935.49 204.54,-993.12"/>
<polygon fill="#00ff91" stroke="#00ff91" points="201.04,-993.04 203.77,-1003.27 208.02,-993.57 201.04,-993.04"/>
</g>
<!-- sourcefile~dtfft_interface_nvtx.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dtfft_interface_nvtx.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M305.31,-1503.17C295.61,-1499.2 286.68,-1493.53 280,-1485.5 222.07,-1415.88 273.27,-1165.22 244,-1079.5 238.58,-1063.63 228.43,-1047.73 219.59,-1035.76"/>
<polygon fill="#00ffff" stroke="#00ffff" points="222.33,-1033.58 213.46,-1027.78 216.78,-1037.85 222.33,-1033.58"/>
</g>
<!-- sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M763.02,-625.55C731.14,-662.16 635.16,-772.41 595.72,-817.73"/>
<polygon fill="#0024ff" stroke="#0024ff" points="592.96,-815.56 589.04,-825.4 598.24,-820.16 592.96,-815.56"/>
</g>
<!-- sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M758.7,-625.54C738.42,-642.99 702.6,-677.44 686,-715.5 657.75,-780.29 699.36,-980.92 650,-1031.5 509.92,-1175.04 379.27,-997.81 203,-1093.5"/>
</g>
<!-- sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M727.43,-625.15C713.87,-629.12 699.15,-633.98 686,-639.5 669.13,-646.6 666.75,-652.11 650,-659.5 619.33,-673.03 611.98,-681.8 578.5,-683.5"/>
</g>
<!-- sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M729.08,-601.49C715.16,-597.41 699.83,-592.59 686,-587.5 603.46,-557.14 578.61,-555.63 505,-507.5 486.83,-495.62 488.34,-484.36 469,-474.5 431.22,-455.25 410.59,-431.69 375.5,-455.5"/>
</g>
<!-- sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dtfft_pencil.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M727.31,-611.76C673.34,-608.94 581.67,-601.71 505,-583.5 445.28,-569.32 423.64,-497.42 375.5,-535.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1371.29,-601.46C1358.9,-597.86 1346.25,-593.28 1335,-587.5 1288.82,-563.78 1244.23,-521.79 1220.23,-497.12"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1222.63,-494.56 1213.19,-489.76 1217.58,-499.4 1222.63,-494.56"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1351.38,-625.75C1345.16,-629.34 1339.54,-633.85 1335,-639.5 1273.91,-715.53 1333.95,-1425.45 1299,-1516.5 1241.09,-1667.38 1192.01,-1694.07 1067,-1796.5 1010.09,-1843.14 845.79,-1931.78 775.5,-1953.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1352.11,-625.72C1345.65,-629.3 1339.78,-633.82 1335,-639.5 1275.12,-710.68 1332.89,-969.89 1299,-1056.5 1237.71,-1213.14 1209.49,-1266.12 1067,-1355.5 1010.9,-1390.69 841.66,-1414.49 775.5,-1417.5"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M773.5,-1417.5C686.93,-1421.54 661.55,-1392.73 578.5,-1417.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1431.79,-601.21C1424.6,-553.76 1392.71,-380.25 1299,-280.5 1220.73,-197.19 1178.47,-194.8 1067,-169.5 994.18,-152.98 973.43,-163.52 899,-169.5 843.58,-173.96 831.1,-188.53 775.5,-189.5"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M773.5,-189.5C686.86,-187.43 651.31,-142.49 578.5,-189.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1334.58,-607.32C1243.33,-602.97 1104.2,-599.8 984,-611.5"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M982,-611.5C931.44,-617.36 873.45,-617.34 831.82,-616.15"/>
<polygon fill="#4800ff" stroke="#4800ff" points="831.71,-612.65 821.6,-615.83 831.49,-619.65 831.71,-612.65"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dtfft_reshape_handle_datatype.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M982,-611.5C943.86,-615.92 932.62,-616.96 899,-635.5 880.26,-645.84 881.88,-657.42 863,-667.5 826.75,-686.86 543.16,-745.23 505,-760.5 398.79,-803 362,-805.74 280,-885.5 247.32,-917.29 223.52,-965.83 211.61,-993.73"/>
<polygon fill="#4800ff" stroke="#4800ff" points="208.23,-992.76 207.63,-1003.33 214.69,-995.43 208.23,-992.76"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1433.5,-767.5C1330.96,-759 1304.49,-776.6 1202,-767.5"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1200,-767.5C1130.55,-761.34 1055.19,-727.2 1014.4,-706.18"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1016,-703.07 1005.52,-701.53 1012.75,-709.27 1016,-703.07"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1657.74,-755.37C1634.72,-719.69 1566.4,-616.12 1534,-592.5 1458.56,-537.51 1354.66,-507.17 1283.29,-491.66"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1283.95,-488.22 1273.44,-489.57 1282.5,-495.07 1283.95,-488.22"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1665.03,-779.72C1661.29,-872.24 1633.7,-1462.64 1534,-1604.5 1316.39,-1914.14 1147.47,-1921.73 775.5,-1991.5"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M773.5,-1991.5C686.11,-2004.09 666.69,-2025.26 578.5,-2029.5"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M576.5,-2029.5C487.27,-2033.8 457.6,-2064.72 375.5,-2029.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1653.81,-755.25C1632.75,-732.31 1588.89,-680.43 1570,-627.5 1539.03,-540.74 1581.51,-293.43 1534,-214.5 1447.88,-71.41 1364.77,-75.9 1202,-38.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1200,-767.5C1064.38,-755.47 1007.86,-792.29 899,-710.5 870.71,-689.25 890.17,-662.16 863,-639.5 853.96,-631.97 842.81,-626.61 831.52,-622.81"/>
<polygon fill="#b600ff" stroke="#b600ff" points="832.21,-619.36 821.62,-619.86 830.2,-626.07 832.21,-619.36"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1664.78,-779.7C1659.46,-866.04 1624,-1385.29 1534,-1509.5 1435.76,-1645.08 1369.43,-1687.5 1202,-1687.5 1202,-1687.5 1202,-1687.5 982,-1687.5 707.39,-1687.5 592.32,-1738.03 375.5,-1569.5"/>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1663.56,-779.75C1649.36,-867.58 1558.71,-1400.51 1435.5,-1495.5"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1433.5,-1495.5C1385.59,-1532.45 1358.98,-1482.4 1299,-1474.5 1027.33,-1438.71 954.87,-1461.37 686,-1408.5 665.39,-1404.45 643.01,-1398.29 624.03,-1392.52"/>
<polygon fill="#b600ff" stroke="#b600ff" points="625.03,-1389.17 614.44,-1389.56 622.96,-1395.86 625.03,-1389.17"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dtfft_backend_cufftmp.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dtfft_backend_cufftmp.f90.html" xlink:title="dtfft_backend_cufftmp.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1278,-409.5 1124,-409.5 1124,-385.5 1278,-385.5 1278,-409.5"/>
<text text-anchor="middle" x="1201" y="-395.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_backend_cufftmp.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_backend_cufftmp.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_backend_cufftmp.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1655.06,-755.22C1635.68,-731.84 1593.93,-678.67 1570,-627.5 1545.15,-574.36 1574.97,-542.49 1534,-500.5 1469.5,-434.39 1363.45,-410.52 1288.6,-402"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1288.56,-398.48 1278.25,-400.9 1287.82,-405.44 1288.56,-398.48"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dtfft_backend_mpi.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dtfft_backend_mpi.f90.html" xlink:title="dtfft_backend_mpi.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1267.5,-1507.5 1134.5,-1507.5 1134.5,-1483.5 1267.5,-1483.5 1267.5,-1507.5"/>
<text text-anchor="middle" x="1201" y="-1493.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_backend_mpi.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_backend_mpi.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_backend_mpi.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1433.5,-1495.5C1379.81,-1534.74 1298.81,-1523.26 1248.23,-1510.23"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1249.11,-1506.84 1238.54,-1507.61 1247.29,-1513.59 1249.11,-1506.84"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dtfft_backend_nccl.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dtfft_backend_nccl.f90.html" xlink:title="dtfft_backend_nccl.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1268.5,-701.5 1133.5,-701.5 1133.5,-677.5 1268.5,-677.5 1268.5,-701.5"/>
<text text-anchor="middle" x="1201" y="-687.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_backend_nccl.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_backend_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_backend_nccl.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1569.96,-771.03C1528.56,-771.65 1479.57,-771.16 1435.5,-767.5"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1433.5,-767.5C1359.28,-761.35 1277.94,-726.93 1234.19,-705.92"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1235.7,-702.77 1225.18,-701.53 1232.63,-709.06 1235.7,-702.77"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dtfft_kernel_device.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dtfft_kernel_device.f90.html" xlink:title="dtfft_kernel_device.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1502.5,-969.5 1366.5,-969.5 1366.5,-945.5 1502.5,-945.5 1502.5,-969.5"/>
<text text-anchor="middle" x="1434.5" y="-955.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_kernel_device.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_kernel_device.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_kernel_device.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1650.76,-779.68C1611.57,-812.05 1504.6,-900.42 1457.85,-939.04"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1455.6,-936.36 1450.11,-945.43 1460.05,-941.76 1455.6,-936.36"/>
</g>
<!-- sourcefile~dtfft_kernel_host.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dtfft_kernel_host.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dtfft_kernel_host.f90.html" xlink:title="dtfft_kernel_host.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="836.5,-1545.5 712.5,-1545.5 712.5,-1521.5 836.5,-1521.5 836.5,-1545.5"/>
<text text-anchor="middle" x="774.5" y="-1531.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_kernel_host.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_kernel_host.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dtfft_reshape_handle_generic.f90&#45;&gt;sourcefile~dtfft_kernel_host.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M1433.5,-1495.5C1248.17,-1630.95 949.24,-1577.45 828.55,-1547.96"/>
<polygon fill="#b600ff" stroke="#b600ff" points="829.35,-1544.55 818.8,-1545.53 827.66,-1551.34 829.35,-1544.55"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-613.5C1652.96,-610.18 1448.3,-651.41 1435.5,-653.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1433.5,-653.5C1331.94,-670.09 1304.82,-645.22 1202,-649.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1200,-649.5C1144.32,-651.82 1081.83,-664.53 1038.45,-675"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1037.55,-671.62 1028.67,-677.4 1039.22,-678.42 1037.55,-671.62"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_abstract_reshape_handle.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1835.25,-658.42C1792.26,-646.83 1725.46,-628.87 1667.5,-613.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-613.5C1472.84,-562.41 1631.74,-193.59 1435.5,-228.5"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1433.5,-653.5C1369.42,-663.96 1361.64,-693.43 1299,-710.5 1033.86,-782.77 951.01,-718.77 686,-791.5 671.85,-795.39 639.41,-809.55 613.85,-821.14"/>
<polygon fill="#ff00da" stroke="#ff00da" points="612.08,-818.1 604.44,-825.43 614.99,-824.47 612.08,-818.1"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1433.5,-1953.5C1155.04,-2044.45 1065.44,-1949.73 775.5,-1991.5"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1433.5,-38.5C1388.58,-35.01 1375.57,-42.9 1335,-62.5 1316.75,-71.32 1317.46,-82.12 1299,-90.5 1134,-165.43 1054.6,-76.62 899,-169.5 861.8,-191.71 681.16,-439.41 650,-469.5 566.63,-549.99 453.48,-629.27 402.44,-663.67"/>
<polygon fill="#ff00da" stroke="#ff00da" points="400.29,-660.9 393.94,-669.38 404.19,-666.71 400.29,-660.9"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-114.5C1584.13,-55.35 953.56,-376.42 899,-407.5 861.96,-428.61 822.37,-458.22 798.28,-477.13"/>
<polygon fill="#ff00da" stroke="#ff00da" points="796.1,-474.39 790.43,-483.34 800.44,-479.88 796.1,-474.39"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nvshmem.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nvshmem.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-114.5C1644.55,-99.27 1460.95,-71.71 1435.5,-76.5"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-1801.5C1615.35,-1841.48 669.18,-1590.52 430.04,-1526.24"/>
<polygon fill="#ff00da" stroke="#ff00da" points="430.75,-1522.8 420.18,-1523.58 428.93,-1529.56 430.75,-1522.8"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1879.71,-658.47C1877.39,-591.04 1856.4,-257.89 1667.5,-114.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-114.5C1630.64,-88.04 1609.34,-109.68 1570,-90.5 1551.78,-81.62 1552.25,-71.32 1534,-62.5 1493.43,-42.9 1480.39,-42.37 1435.5,-38.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1433.5,-38.5C1330.99,-29.67 1302.47,-60.69 1202,-38.5"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-613.5C1360.25,-532.55 975.11,-580.86 832.22,-603.63"/>
<polygon fill="#ff00da" stroke="#ff00da" points="831.27,-600.24 821.95,-605.29 832.39,-607.15 831.27,-600.24"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_reshape_handle_datatype.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_reshape_handle_datatype.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-613.5C1626.79,-603.24 1583.11,-601.02 1544.3,-602.11"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1543.89,-598.62 1534.02,-602.48 1544.14,-605.62 1543.89,-598.62"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_reshape_handle_generic.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_reshape_handle_generic.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1853.52,-682.59C1815.56,-699.92 1745.58,-731.86 1703.12,-751.24"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1701.63,-748.08 1693.98,-755.41 1704.53,-754.45 1701.63,-748.08"/>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-613.5C1660.66,-612.31 1339.3,-750.98 1335,-753.5 1317.52,-763.76 1317.17,-772.51 1299,-781.5 1083.33,-888.19 1015.05,-896.84 775.5,-919.5"/>
</g>
<!-- sourcefile~dtfft_interface_cuda.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dtfft_interface_cuda.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dtfft_interface_cuda.f90.html" xlink:title="dtfft_interface_cuda.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648.5,-1259.5 506.5,-1259.5 506.5,-1235.5 648.5,-1235.5 648.5,-1259.5"/>
<text text-anchor="middle" x="577.5" y="-1245.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_cuda.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1862.73,-682.64C1843.62,-697.12 1813.6,-723.21 1799,-753.5 1697.12,-964.95 1854.34,-1659.44 1667.5,-1801.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-1801.5C1587.49,-1860.82 1406.88,-1576.12 1335,-1509.5 1318.63,-1494.33 1317.6,-1486.83 1299,-1474.5 1172.34,-1390.53 1135.96,-1339.87 984,-1341.5"/>
</g>
<!-- sourcefile~dtfft_interface_nvrtc.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dtfft_interface_nvrtc.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dtfft_interface_nvrtc.f90.html" xlink:title="dtfft_interface_nvrtc.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648.5,-1773.5 506.5,-1773.5 506.5,-1749.5 648.5,-1749.5 648.5,-1773.5"/>
<text text-anchor="middle" x="577.5" y="-1759.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_nvrtc.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nvrtc.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dtfft_reshape_plan_base.f90&#45;&gt;sourcefile~dtfft_interface_nvrtc.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1665.5,-1801.5C1631.28,-1828.78 1604.6,-1798.71 1570,-1825.5 1543.58,-1845.96 1556.88,-1867.15 1534,-1891.5 1498.58,-1929.2 1485.07,-1938.71 1435.5,-1953.5"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1433.5,-1953.5C1275.67,-2000.6 773.18,-1830.67 621.96,-1777.15"/>
<polygon fill="#ff00da" stroke="#ff00da" points="622.7,-1773.7 612.1,-1773.65 620.35,-1780.29 622.7,-1773.7"/>
</g>
<!-- sourcefile~dtfft_utils.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dtfft_utils.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M193.48,-1027.6C180.08,-1048.97 150.96,-1094.62 124,-1131.5 109.68,-1151.09 92.26,-1172.59 79.7,-1187.71"/>
<polygon fill="#ff006d" stroke="#ff006d" points="77.01,-1185.48 73.28,-1195.4 82.38,-1189.96 77.01,-1185.48"/>
</g>
<!-- sourcefile~dtfft_utils.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dtfft_utils.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M181.26,-1027.72C174.47,-1032.01 166.86,-1036.9 160,-1041.5 135.16,-1058.2 107.38,-1078.08 87.94,-1092.21"/>
<polygon fill="#ff006d" stroke="#ff006d" points="85.65,-1089.54 79.63,-1098.26 89.78,-1095.2 85.65,-1089.54"/>
</g>
<!-- sourcefile~dtfft_abstract_kernel.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dtfft_abstract_kernel.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M526.95,-1389.52C518.96,-1393.07 511.26,-1397.63 505,-1403.5 475.96,-1430.72 499.08,-1459.43 469,-1485.5 464.15,-1489.7 458.68,-1493.23 452.88,-1496.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="451.21,-1493.1 443.52,-1500.39 454.08,-1499.48 451.21,-1493.1"/>
</g>
<!-- sourcefile~dtfft_abstract_kernel.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dtfft_abstract_kernel.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M373.5,-1471.5C331.27,-1467.65 312.55,-1463.32 280,-1490.5 209.12,-1549.7 278.61,-1736.54 203,-1683.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201,-1683.5C109.5,-1619.32 169.06,-1288.78 124,-1186.5 114.45,-1164.82 97.09,-1144.11 83.32,-1129.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="85.65,-1127.18 76.12,-1122.55 80.68,-1132.11 85.65,-1127.18"/>
</g>
<!-- sourcefile~dtfft_abstract_kernel.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dtfft_abstract_kernel.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M540.48,-1389.53C529.01,-1393.64 516.36,-1398.48 505,-1403.5 445.54,-1429.78 440.24,-1477.41 375.5,-1471.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M373.5,-1471.5C190.78,-1454.84 322.88,-1245.16 244,-1079.5 236.77,-1064.31 226.57,-1048.38 218.15,-1036.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="220.77,-1033.85 212.14,-1027.71 215.06,-1037.9 220.77,-1033.85"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1165.99,-409.64C1144.53,-419.08 1118.1,-434.35 1103,-456.5 1050.41,-533.66 1128.55,-593.28 1067,-663.5 1064.14,-666.76 1060.89,-669.61 1057.35,-672.11"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1055.44,-669.18 1048.66,-677.33 1059.04,-675.18 1055.44,-669.18"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1163.53,-409.62C1141.93,-418.85 1116.27,-433.89 1103,-456.5 1048.14,-550 1106.74,-1330.64 1067,-1431.5 1025.19,-1537.62 972.95,-1538.66 899,-1625.5 882.84,-1644.48 882.34,-1652.78 863,-1668.5 779.69,-1736.23 754.15,-1756.38 650,-1782.5 457.13,-1830.87 336.14,-1911.19 203,-1763.5"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M773.5,-573.5C736.85,-589.01 721.69,-574.9 686,-592.5 629.86,-620.19 641.02,-680.33 578.5,-683.5"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M576.5,-683.5C544.89,-685.11 510.46,-685.32 479.16,-684.93"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="479.17,-681.43 469.12,-684.79 479.07,-688.43 479.17,-681.43"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_interface_nvshmem.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_interface_nvshmem.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1189.93,-385.39C1168.51,-359.93 1116.36,-299.5 1067,-254.5 1048.79,-237.9 1026.63,-220.96 1009.78,-208.68"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1011.67,-205.72 1001.51,-202.71 1007.57,-211.4 1011.67,-205.72"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1168.58,-385.5C1045.97,-338.85 605.11,-172.98 578.5,-189.5"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_pencil.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_pencil.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M982,-421.5C946.63,-436.45 925.7,-417.9 899,-445.5 853.73,-492.3 908.1,-540.54 863,-587.5 854.51,-596.34 843.16,-602.22 831.46,-606.11"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="830.25,-602.81 821.6,-608.93 832.18,-609.54 830.25,-602.81"/>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1123.85,-395.45C1081.22,-396.85 1027.97,-402.93 984,-421.5"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M982,-421.5C946.63,-436.45 928.58,-421.01 899,-445.5 871.75,-468.06 886.63,-490.17 863,-516.5 832,-551.05 818.24,-555.41 775.5,-573.5"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M773.5,-573.5C691.68,-608.14 442.39,-477.02 375.5,-535.5"/>
</g>
<!-- sourcefile~dtfft_interface_cufft.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~dtfft_interface_cufft.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/dtfft_interface_cufft.f90.html" xlink:title="dtfft_interface_cufft.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="444,-507.5 305,-507.5 305,-483.5 444,-483.5 444,-507.5"/>
<text text-anchor="middle" x="374.5" y="-493.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_interface_cufft.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_interface_cufft.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dtfft_backend_cufftmp.f90&#45;&gt;sourcefile~dtfft_interface_cufft.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1124,-387.64C992.61,-373.73 716.76,-358.5 505,-441.5 486.13,-448.9 487.11,-460.39 469,-469.5 460.62,-473.72 451.47,-477.33 442.27,-480.4"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="441.19,-477.07 432.7,-483.41 443.29,-483.75 441.19,-477.07"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1197.45,-1483.37C1184.89,-1423.94 1127.74,-1157.84 1067,-943.5 1042.35,-856.5 1007.11,-754.72 991.71,-711.12"/>
<polygon fill="#7fff00" stroke="#7fff00" points="994.96,-709.81 988.32,-701.56 988.36,-712.15 994.96,-709.81"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1189.96,-1507.52C1170.84,-1530.88 1128.82,-1584.61 1103,-1635.5 1080.87,-1679.12 1099.09,-1702.58 1067,-1739.5 1011.98,-1802.82 959.09,-1766.97 899,-1825.5 875.07,-1848.82 885.2,-1866.53 863,-1891.5 831.33,-1927.12 820.82,-1938.74 775.5,-1953.5"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M773.5,-1953.5C690.7,-1979.1 661.92,-1930.02 578.5,-1953.5"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1197.99,-1483.42C1189.7,-1436.73 1154.41,-1265.37 1067,-1158.5 1010.65,-1089.61 959.09,-1115.17 899,-1049.5 875.91,-1024.27 890.31,-1002.09 863,-981.5 759.8,-903.72 687.26,-991.29 578.5,-921.5"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M576.5,-921.5C485.53,-862.22 414.13,-749.29 387.16,-702.56"/>
<polygon fill="#7fff00" stroke="#7fff00" points="390.07,-700.6 382.09,-693.64 383.98,-704.06 390.07,-700.6"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1134.25,-1500.42C1035.28,-1505.98 842.89,-1509.65 686,-1469.5 634.58,-1456.34 629.5,-1402.8 578.5,-1417.5"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1188.97,-1507.78C1167.03,-1531.84 1115.83,-1586.27 1067,-1625.5 997.43,-1681.4 956.97,-1667.64 899,-1735.5 873.67,-1765.15 895.74,-1794.33 863,-1815.5 774.72,-1872.59 418.18,-1851.01 280,-1777.5 232.32,-1752.14 248.33,-1712.86 203,-1683.5"/>
</g>
<!-- sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dtfft_backend_mpi.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1153.18,-1507.57C997.49,-1546.51 500,-1661.13 375.5,-1569.5"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_abstract_backend.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1133.43,-689.5C1113.94,-689.5 1092.32,-689.5 1071.72,-689.5"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1071.71,-686 1061.71,-689.5 1071.71,-693 1071.71,-686"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1167.34,-701.65C1145,-711.84 1117,-728.74 1103,-753.5 1007.58,-922.35 1161.33,-1456.04 1067,-1625.5 1023.11,-1704.35 957.71,-1670.98 899,-1739.5 874.68,-1767.88 889.31,-1788.95 863,-1815.5 764.09,-1915.33 713.78,-1915.42 578.5,-1953.5"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M576.5,-1953.5C484.86,-1980.39 463.27,-2067.15 375.5,-2029.5"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M373.5,-2029.5C334.07,-2012.59 311.19,-2034.97 280,-2005.5 197.96,-1927.99 278.58,-1847.33 203,-1763.5"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M982,-649.5C893.37,-625.6 867.23,-650.08 775.5,-653.5"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M773.5,-653.5C685.87,-656.77 666.07,-679.06 578.5,-683.5"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_interface_nccl.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1133.21,-679.97C1090.21,-673.14 1033.34,-662.81 984,-649.5"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M982,-649.5C944.92,-639.51 926.85,-651.94 899,-625.5 863.53,-591.82 898.35,-555.31 863,-521.5 859.4,-518.06 855.36,-515.06 851.04,-512.47"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="852.34,-509.19 841.85,-507.67 849.1,-515.4 852.34,-509.19"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1185.74,-677.39C1100.91,-606.85 657.02,-258.95 375.5,-455.5"/>
</g>
<!-- sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dtfft_backend_nccl.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1181.66,-701.78C1112.47,-747.73 866.5,-907.56 775.5,-919.5"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M773.5,-919.5C655.23,-936.94 623.45,-951.66 505,-935.5 445.81,-927.43 430.84,-877 375.5,-899.5"/>
</g>
<!-- sourcefile~dtfft_interface_cuda.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dtfft_interface_cuda.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M201,-1207.5C174.32,-1203.01 144.32,-1202.48 119.12,-1203.3"/>
<polygon fill="#00ffff" stroke="#00ffff" points="118.86,-1199.8 109,-1203.7 119.14,-1206.8 118.86,-1199.8"/>
</g>
<!-- sourcefile~dtfft_interface_cuda.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dtfft_interface_cuda.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M506.29,-1242.51C430.96,-1236.57 307.99,-1225.17 203,-1207.5"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M201,-1207.5C151.09,-1195.81 104.91,-1154.75 80.7,-1129.96"/>
<polygon fill="#00ffff" stroke="#00ffff" points="83.06,-1127.36 73.63,-1122.53 77.99,-1132.19 83.06,-1127.36"/>
</g>
<!-- sourcefile~dtfft_interface_cuda.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dtfft_interface_cuda.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M556.94,-1235.36C495.05,-1196.91 303.26,-1077.78 230.96,-1032.87"/>
<polygon fill="#00ffff" stroke="#00ffff" points="232.7,-1029.83 222.36,-1027.53 229.01,-1035.78 232.7,-1029.83"/>
</g>
<!-- sourcefile~dtfft_interface_nvrtc.f90&#45;&gt;sourcefile~dtfft_errors.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dtfft_interface_nvrtc.f90&#45;&gt;sourcefile~dtfft_errors.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M373.5,-1763.5C309.47,-1722.97 253.31,-1820.17 203,-1763.5"/>
</g>
<!-- sourcefile~dtfft_interface_nvrtc.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dtfft_interface_nvrtc.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M537.59,-1773.56C494.43,-1784.45 424.45,-1794.49 375.5,-1763.5"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M373.5,-1763.5C297.33,-1715.28 304.5,-1670.26 280,-1583.5 218.98,-1367.38 314.76,-1292.64 244,-1079.5 238.71,-1063.58 228.57,-1047.69 219.69,-1035.72"/>
<polygon fill="#003fff" stroke="#003fff" points="222.42,-1033.53 213.54,-1027.76 216.88,-1037.81 222.42,-1033.53"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M773.5,-805.5C722.38,-799.74 664.25,-811.71 624.85,-822.61"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="623.66,-819.31 615.01,-825.42 625.58,-826.04 623.66,-819.31"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1395.47,-945.47C1295.32,-914.5 1015.5,-832.57 775.5,-805.5"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M773.5,-805.5C673.17,-785.88 680.6,-678.32 578.5,-683.5"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M982,-1417.5C890.28,-1420.63 867.18,-1413.33 775.5,-1417.5"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1424.08,-945.11C1403.67,-917.5 1355.55,-848.08 1335,-781.5 1308.35,-695.17 1352.63,-449.22 1299,-376.5 1262.34,-326.79 837.24,-187.78 775.5,-189.5"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1366.31,-953.64C1278.27,-949.47 1119.21,-944.97 984,-957.5"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M982,-957.5C889.25,-967.82 868.4,-910.72 775.5,-919.5"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1433.48,-969.56C1432.69,-1023.86 1421.87,-1247.82 1299,-1355.5 1191.69,-1449.55 1126.54,-1423.98 984,-1417.5"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M982,-1417.5C928.75,-1418.36 915.97,-1409.04 863,-1403.5 794.71,-1396.37 717.08,-1389.34 660.18,-1384.4"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="660.43,-1380.91 650.17,-1383.53 659.83,-1387.88 660.43,-1380.91"/>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1427.17,-969.84C1392.5,-1035.57 1218.53,-1341.5 984,-1341.5"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M982,-1341.5C843.28,-1351.94 683.86,-1292.96 614.2,-1263.49"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="615.54,-1260.26 604.97,-1259.54 612.79,-1266.69 615.54,-1260.26"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dtfft_nvrtc_block_optimizer.f90.html" xlink:title="dtfft_nvrtc_block_optimizer.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="863,-1085.5 686,-1085.5 686,-1061.5 863,-1061.5 863,-1085.5"/>
<text text-anchor="middle" x="774.5" y="-1071.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_nvrtc_block_optimizer.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_nvrtc_block_optimizer.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_nvrtc_block_optimizer.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M982,-957.5C915.97,-963.62 922.18,-1017.58 863,-1047.5 854.9,-1051.6 846.04,-1055.16 837.17,-1058.23"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="836,-1054.93 827.58,-1061.36 838.17,-1061.59 836,-1054.93"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dtfft_nvrtc_module_cache.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dtfft_nvrtc_module_cache.f90.html" xlink:title="dtfft_nvrtc_module_cache.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1287,-1047.5 1115,-1047.5 1115,-1023.5 1287,-1023.5 1287,-1047.5"/>
<text text-anchor="middle" x="1201" y="-1033.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_nvrtc_module_cache.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_nvrtc_module_cache.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dtfft_kernel_device.f90&#45;&gt;sourcefile~dtfft_nvrtc_module_cache.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1397.84,-969.52C1357.39,-983.15 1291.36,-1005.39 1247.3,-1020.24"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1246.06,-1016.96 1237.71,-1023.47 1248.3,-1023.6 1246.06,-1016.96"/>
</g>
<!-- sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M768.17,-1521.38C752.58,-1485.34 706.86,-1375.44 686,-1279.5 650.71,-1117.19 721.69,-1057.34 650,-907.5 639.91,-886.42 620.68,-868.16 604.7,-855.58"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="606.79,-852.78 596.7,-849.54 602.57,-858.36 606.79,-852.78"/>
</g>
<!-- sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M726.59,-1521.46C678.46,-1509.54 606.75,-1493.12 578.5,-1493.5"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M576.5,-1493.5C535.99,-1494.05 491.07,-1497.78 453.99,-1501.7"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="453.31,-1498.25 443.75,-1502.81 454.06,-1505.21 453.31,-1498.25"/>
</g>
<!-- sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M731.11,-1545.57C600.78,-1582.55 214.15,-1691.32 203,-1683.5"/>
</g>
<!-- sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M576.5,-1493.5C481,-1494.8 452.42,-1626.11 375.5,-1569.5"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M373.5,-1569.5C337.51,-1543.01 306.57,-1568.44 280,-1532.5 219.97,-1451.3 276.2,-1175.22 244,-1079.5 238.65,-1063.6 228.5,-1047.71 219.64,-1035.74"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="222.38,-1033.56 213.5,-1027.77 216.83,-1037.83 222.38,-1033.56"/>
</g>
<!-- sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dtfft_kernel_host.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M751.99,-1521.5C732.88,-1510.04 705.1,-1491.31 686,-1469.5 663.98,-1444.37 675.34,-1425.29 650,-1403.5 645.81,-1399.9 641.07,-1396.77 636.08,-1394.08"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="637.43,-1390.84 626.9,-1389.66 634.39,-1397.15 637.43,-1390.84"/>
</g>
<!-- sourcefile~dtfft_interface_cufft.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dtfft_interface_cufft.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M304.71,-507.23C295.78,-510.8 287.24,-515.45 280,-521.5 219.48,-572.15 254.9,-622.05 203,-681.5"/>
</g>
<!-- sourcefile~dtfft_interface_cufft.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dtfft_interface_cufft.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M304.82,-504.61C295.43,-508.51 286.72,-513.95 280,-521.5 263.96,-539.54 217.65,-899.25 205.79,-993.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.3,-992.95 204.52,-1003.31 209.24,-993.83 202.3,-992.95"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M749.58,-1061.32C729.99,-1050.24 702.84,-1032.16 686,-1009.5 657.32,-970.92 675.85,-948.04 650,-907.5 637.31,-887.61 617.96,-869.11 602.58,-856.14"/>
<polygon fill="#00ff00" stroke="#00ff00" points="604.47,-853.16 594.52,-849.52 600.03,-858.57 604.47,-853.16"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M706.83,-1061.45C667.92,-1052.71 618.72,-1038.65 578.5,-1017.5"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M576.5,-1017.5C512.12,-983.65 414.91,-771.57 384.75,-702.92"/>
<polygon fill="#00ff00" stroke="#00ff00" points="387.86,-701.29 380.65,-693.52 381.44,-704.09 387.86,-701.29"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M685.94,-1066.2C566.28,-1058.08 345.35,-1049.68 160,-1079.5 140.59,-1082.63 119.75,-1088.88 102.37,-1094.96"/>
<polygon fill="#00ff00" stroke="#00ff00" points="100.8,-1091.81 92.58,-1098.5 103.18,-1098.39 100.8,-1091.81"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M576.5,-1017.5C497.43,-975.92 463.31,-1033.93 375.5,-1017.5"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M373.5,-1017.5C333.94,-1010.1 288.32,-1010 254.23,-1011.53"/>
<polygon fill="#00ff00" stroke="#00ff00" points="253.85,-1008.04 244.04,-1012.05 254.2,-1015.03 253.85,-1008.04"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M748.76,-1085.6C728.95,-1096.52 701.92,-1114.42 686,-1137.5 651.72,-1187.21 674.86,-1213.48 650,-1268.5 635,-1301.71 610.59,-1336.26 594.53,-1357.33"/>
<polygon fill="#00ff00" stroke="#00ff00" points="591.57,-1355.44 588.22,-1365.49 597.11,-1359.72 591.57,-1355.44"/>
</g>
<!-- sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dtfft_nvrtc_block_optimizer.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M750.73,-1085.52C731.32,-1096.75 703.81,-1115.12 686,-1137.5 660.71,-1169.29 679.52,-1193.6 650,-1221.5 646.26,-1225.04 641.99,-1228.11 637.46,-1230.76"/>
<polygon fill="#00ff00" stroke="#00ff00" points="635.77,-1227.69 628.46,-1235.37 638.96,-1233.92 635.77,-1227.69"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1114.83,-1036.69C1075.07,-1036.94 1027.11,-1036.81 984,-1035.5"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982,-1035.5C935.44,-1034.09 929.24,-1006.93 899,-971.5 877.31,-946.09 889.54,-925.8 863,-905.5 844.95,-891.7 713.1,-863.96 635.38,-848.52"/>
<polygon fill="#0000ff" stroke="#0000ff" points="635.74,-845.02 625.25,-846.52 634.38,-851.89 635.74,-845.02"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1184.71,-1023.36C1160.65,-1004.62 1112.04,-968.23 1067,-943.5 980.75,-896.15 956.85,-887.07 863,-857.5 786.26,-833.32 761.35,-847.72 686,-819.5 582.79,-780.85 572.62,-737.05 469,-699.5 465.89,-698.38 462.7,-697.32 459.45,-696.32"/>
<polygon fill="#0000ff" stroke="#0000ff" points="460.16,-692.88 449.59,-693.51 458.25,-699.61 460.16,-692.88"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982,-1035.5C922.99,-1033.71 920.48,-1081.04 863,-1094.5 649.43,-1144.54 591.11,-1057.83 375.5,-1017.5"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982,-1237.5C864.26,-1296.57 715.62,-1341.08 635.66,-1362.79"/>
<polygon fill="#0000ff" stroke="#0000ff" points="634.53,-1359.47 625.79,-1365.45 636.36,-1366.22 634.53,-1359.47"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1192.87,-1047.93C1175.14,-1077.89 1126.19,-1154.95 1067,-1200.5 1034.99,-1225.13 1020.53,-1220.28 984,-1237.5"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982,-1237.5C953.65,-1250.86 767.84,-1250.43 658.51,-1248.96"/>
<polygon fill="#0000ff" stroke="#0000ff" points="658.55,-1245.46 648.5,-1248.82 658.45,-1252.46 658.55,-1245.46"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_nvrtc_block_optimizer.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_nvrtc_block_optimizer.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M982,-1035.5C926.97,-1033.83 864.99,-1047.36 823.42,-1058.74"/>
<polygon fill="#0000ff" stroke="#0000ff" points="822.25,-1055.43 813.56,-1061.5 824.14,-1062.17 822.25,-1055.43"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dtfft_nvrtc_module.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dtfft_nvrtc_module.f90.html" xlink:title="dtfft_nvrtc_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1050.5,-1191.5 915.5,-1191.5 915.5,-1167.5 1050.5,-1167.5 1050.5,-1191.5"/>
<text text-anchor="middle" x="983" y="-1177.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_nvrtc_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_nvrtc_module.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dtfft_nvrtc_module_cache.f90&#45;&gt;sourcefile~dtfft_nvrtc_module.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1181.96,-1047.53C1143.92,-1072.89 1055.34,-1131.94 1010.71,-1161.69"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1008.52,-1158.95 1002.15,-1167.41 1012.41,-1164.77 1008.52,-1158.95"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_config.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_config.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M971.1,-1167.14C946.36,-1139.18 886.27,-1072.01 863,-1052.5 827.43,-1022.69 813.07,-1022.76 775.5,-995.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-995.5C708.2,-948.13 635.35,-886.63 600.03,-856.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="602.14,-853.42 592.28,-849.53 597.57,-858.72 602.14,-853.42"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_cuda_runtime.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-995.5C740.86,-971.82 723.86,-985.39 686,-971.5 636.53,-953.36 622.85,-949.96 578.5,-921.5"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_nvtx.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-1265.5C702.36,-1303.52 719.14,-1356.96 650,-1398.5 621.82,-1415.44 610.09,-1408.39 578.5,-1417.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M576.5,-1417.5C522.18,-1433.17 520.68,-1462.57 469,-1485.5 459.55,-1489.7 449.25,-1493.38 439.06,-1496.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="437.94,-1493.22 429.35,-1499.42 439.94,-1499.93 437.94,-1493.22"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_parameters.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M576.5,-1169.5C421.27,-1133.21 234.2,-1118.87 134.24,-1113.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="134.42,-1110 124.25,-1112.98 134.05,-1116.99 134.42,-1110"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_utils.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_utils.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M915.46,-1181.93C874.97,-1183.6 822.22,-1186.13 775.5,-1189.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-1189.5C686.6,-1195.77 663.33,-1189.34 578.5,-1169.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M576.5,-1169.5C535.54,-1159.93 533.98,-1137.98 505,-1107.5 487.11,-1088.69 489.3,-1077.69 469,-1061.5 433.1,-1032.86 420.64,-1025.95 375.5,-1017.5"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_abstract_kernel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M947.46,-1191.56C905.68,-1206.67 833.73,-1234.39 775.5,-1265.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-1265.5C737.93,-1284.51 721.83,-1270.99 686,-1289.5 651.19,-1307.48 617.28,-1338.08 597.13,-1358.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="594.42,-1355.8 589.87,-1365.37 599.39,-1360.73 594.42,-1355.8"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_cuda.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M773.5,-1189.5C744.09,-1191.63 670.07,-1215.66 622.16,-1232.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="620.96,-1228.83 612.65,-1235.4 623.24,-1235.44 620.96,-1228.83"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_nvrtc.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_interface_nvrtc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M941.56,-1191.58C925.73,-1198.39 909,-1208.6 899,-1223.5 808.42,-1358.5 945.33,-1447.33 863,-1587.5 811.79,-1674.7 698.02,-1723.91 630.9,-1746.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="629.77,-1743.06 621.35,-1749.5 631.94,-1749.72 629.77,-1743.06"/>
</g>
<!-- sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_nvrtc_block_optimizer.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dtfft_nvrtc_module.f90&#45;&gt;sourcefile~dtfft_nvrtc_block_optimizer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M958.31,-1167.34C921.28,-1148.33 849.6,-1111.54 807.84,-1090.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="809.41,-1086.97 798.91,-1085.52 806.21,-1093.2 809.41,-1086.97"/>
</g>
</g>
</svg>
</div>                <script>
                  var pansourcefiledtfft_reshape_planf90EfferentGraph = svgPanZoom('#sourcefiledtfft_reshape_planf90EfferentGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#EfferentGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="EfferentGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Files dependent on this one</h3>
          </div>
          <div class="card-body">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefiledtfft_reshape_planf90AfferentGraph" width="377pt" height="74pt"
 viewBox="0.00 0.00 377.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 373,-70 373,4 -4,4"/>
<!-- sourcefile~dtfft_reshape_plan.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~dtfft_reshape_plan.f90</title>
<polygon fill="none" stroke="black" points="133,-45 0,-45 0,-21 133,-21 133,-45"/>
<text text-anchor="middle" x="66.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">dtfft_reshape_plan.F90</text>
</g>
<!-- sourcefile~dtfft_plan.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~dtfft_plan.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/dtfft_plan.f90.html" xlink:title="dtfft_plan.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="254,-45 169,-45 169,-21 254,-21 254,-45"/>
<text text-anchor="middle" x="211.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_plan.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_plan.f90&#45;&gt;sourcefile~dtfft_reshape_plan.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~dtfft_plan.f90&#45;&gt;sourcefile~dtfft_reshape_plan.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M168.75,-33C160.75,-33 152.15,-33 143.46,-33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.25,-29.5 133.25,-33 143.25,-36.5 143.25,-29.5"/>
</g>
<!-- sourcefile~dtfft.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~dtfft.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/dtfft.f90.html" xlink:title="dtfft.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358,-66 301,-66 301,-42 358,-42 358,-66"/>
<text text-anchor="middle" x="329.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft.f90&#45;&gt;sourcefile~dtfft_plan.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~dtfft.f90&#45;&gt;sourcefile~dtfft_plan.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M300.72,-48.97C289.71,-46.98 276.7,-44.62 264.1,-42.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="264.59,-38.87 254.12,-40.54 263.34,-45.76 264.59,-38.87"/>
</g>
<!-- sourcefile~dtfft_api.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~dtfft_api.f90</title>
<g id="a_sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/dtfft_api.f90.html" xlink:title="dtfft_api.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="369,-24 290,-24 290,0 369,0 369,-24"/>
<text text-anchor="middle" x="329.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dtfft_api.F90</text>
</a>
</g>
</g>
<!-- sourcefile~dtfft_api.f90&#45;&gt;sourcefile~dtfft_plan.f90 -->
<g id="sourcefile~~dtfft_reshape_plan.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~dtfft_api.f90&#45;&gt;sourcefile~dtfft_plan.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M289.87,-18.99C281.63,-20.48 272.8,-22.08 264.16,-23.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="263.36,-20.24 254.15,-25.46 264.61,-27.12 263.36,-20.24"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#AfferentGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="AfferentGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
          </div>
        </div>
<br>
      <section>
        <h2><span class="anchor" id="src"></span>Source Code</h2>
        <div class="hl codehilite"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!------------------------------------------------------------------------------------------------</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">! Copyright (c) 2021 - 2025, Oleg Shatrov</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="c">! All rights reserved.</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">! This file is part of dtFFT library.</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="c">! dtFFT is free software: you can redistribute it and/or modify</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">! it under the terms of the GNU General Public License as published by</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">! the Free Software Foundation, either version 3 of the License, or</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">! (at your option) any later version.</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="c">! dtFFT is distributed in the hope that it will be useful,</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="c">! GNU General Public License for more details.</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="c">! You should have received a copy of the GNU General Public License</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">! along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="c">!------------------------------------------------------------------------------------------------</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="cp">#include &quot;dtfft_config.h&quot;</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="cp">#include &quot;dtfft.f03&quot;</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="k">module </span><span class="n">dtfft_reshape_plan</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="c">!! This module describes [[reshape_plan]] class</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="k">use </span><span class="n">iso_fortran_env</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="k">use </span><span class="nb">iso_c_binding</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="k">use </span><span class="n">dtfft_abstract_backend</span><span class="p">,</span><span class="w">               </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">backend_helper</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="k">use </span><span class="n">dtfft_abstract_reshape_handle</span><span class="p">,</span><span class="w">        </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">abstract_reshape_handle</span><span class="p">,</span><span class="w"> </span><span class="n">reshape_container</span><span class="p">,</span><span class="w"> </span><span class="n">create_args</span><span class="p">,</span><span class="w"> </span><span class="n">execute_args</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="k">use </span><span class="n">dtfft_config</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="k">use </span><span class="n">dtfft_errors</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="cp">#ifdef DTFFT_WITH_CUDA</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="k">use </span><span class="n">dtfft_interface_cuda_runtime</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="c">! use dtfft_interface_cuda,                 only: load_cuda</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="c">! use dtfft_interface_nvrtc,                only: load_nvrtc</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="cp"># ifdef NCCL_HAVE_COMMREGISTER</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="k">use </span><span class="n">dtfft_abstract_backend</span><span class="p">,</span><span class="w">               </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">NCCL_REGISTER_PREALLOC_SIZE</span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="cp"># endif</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="cp"># ifdef DTFFT_WITH_NVSHMEM</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="k">use </span><span class="n">dtfft_interface_nvshmem</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="cp"># endif</span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="cp"># ifdef DTFFT_WITH_NCCL</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="k">use </span><span class="n">dtfft_interface_nccl</span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="cp"># endif</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="cp">#endif</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="k">use </span><span class="n">dtfft_parameters</span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="k">use </span><span class="n">dtfft_pencil</span><span class="p">,</span><span class="w">                         </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dtfft_pencil_t</span><span class="p">,</span><span class="w"> </span><span class="n">pencil</span><span class="p">,</span><span class="w"> </span><span class="n">pencil_init</span><span class="p">,</span><span class="w"> </span><span class="n">get_local_sizes</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="k">use </span><span class="n">dtfft_reshape_plan_base</span><span class="p">,</span><span class="w">              </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reshape_plan_base</span><span class="p">,</span><span class="w"> </span><span class="n">allocate_plans</span><span class="p">,</span><span class="w"> </span><span class="n">destroy_plans</span><span class="p">,</span><span class="w"> </span><span class="n">execute_autotune</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="k">use </span><span class="n">dtfft_reshape_handle_generic</span><span class="p">,</span><span class="w">         </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reshape_handle_generic</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="k">use </span><span class="n">dtfft_reshape_handle_datatype</span><span class="p">,</span><span class="w">        </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reshape_handle_datatype</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="k">use </span><span class="n">dtfft_utils</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="cp">#include &quot;_dtfft_mpi.h&quot;</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="cp">#include &quot;_dtfft_profile.h&quot;</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="cp">#include &quot;_dtfft_cuda.h&quot;</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="cp">#include &quot;_dtfft_private.h&quot;</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="k">implicit none</span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="k">private</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">reshape_plan</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a>
<a id="ln-57" name="ln-57" href="#ln-57"></a>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">NEIGHBOR_GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="w">  </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">STRIDED_GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a>
<a id="ln-61" name="ln-61" href="#ln-61"></a>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">  </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="k">extends</span><span class="p">(</span><span class="n">reshape_plan_base</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">reshape_plan</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">  </span><span class="c">!! Reshape Plan class</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="w">  </span><span class="c">!! This class is a container for transposition plans</span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">  </span><span class="k">private</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="k">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">init_grid</span><span class="p">(:)</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">final_grid</span><span class="p">(:)</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">  </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comms</span><span class="p">(:)</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">  </span><span class="k">contains</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="k">  private</span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="k">    procedure</span><span class="p">,</span><span class="w">  </span><span class="k">non_overridable</span><span class="p">,</span><span class="w">  </span><span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">),</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">create</span><span class="w">            </span><span class="c">!! Creates transpose plan</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w">  </span><span class="k">non_overridable</span><span class="p">,</span><span class="w">  </span><span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">),</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">get_grid</span><span class="w">          </span><span class="c">!! Returns grid for specified reshape</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">    </span><span class="k">procedure</span><span class="p">,</span><span class="w">  </span><span class="k">non_overridable</span><span class="p">,</span><span class="w">  </span><span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">),</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">destroy</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">  </span><span class="k">end type </span><span class="n">reshape_plan</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="k">contains</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="k">  subroutine </span><span class="n">destroy</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">reshape_plan</span><span class="p">),</span><span class="w">            </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">self</span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span>
<a id="ln-81" name="ln-81" href="#ln-81"></a>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">init_grid</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">init_grid</span><span class="p">)</span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">)</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">    </span><span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">reshape_plan_base</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="k">      do </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">        </span><span class="k">call </span><span class="n">MPI_Comm_free</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">      </span><span class="k">enddo</span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="k">      deallocate</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">)</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="k">  end subroutine </span><span class="n">destroy</span>
<a id="ln-92" name="ln-92" href="#ln-92"></a>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">get_grid</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nb">dim</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="p">)</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">  </span><span class="c">!! Returns grid decomposition for specified dimension</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">reshape_plan</span><span class="p">),</span><span class="w">  </span><span class="k">target</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">self</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">      </span><span class="c">!! Reshape plan</span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">),</span><span class="w">                </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="nb">dim</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">      </span><span class="c">!! Dimension: 1 for initial grid, other values for final grid</span>
<a id="ln-99" name="ln-99" href="#ln-99"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w">     </span><span class="k">pointer</span><span class="p">,</span><span class="w">  </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grid</span><span class="p">(:)</span>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">      </span><span class="c">!! Pointer to grid array</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">dim</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="k">      </span><span class="n">grid</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">init_grid</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">    </span><span class="k">else</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="k">      </span><span class="n">grid</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="k">  end subroutine </span><span class="n">get_grid</span>
<a id="ln-108" name="ln-108" href="#ln-108"></a>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">  </span><span class="k">function </span><span class="n">create</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">ipencil</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">local_comms</span><span class="p">,</span><span class="w"> </span><span class="n">base_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_storage</span><span class="p">,</span><span class="w"> </span><span class="n">effort</span><span class="p">,</span><span class="w"> </span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="n">bricks</span><span class="p">,</span><span class="w"> </span><span class="n">is_final_enabled</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">error_code</span><span class="p">)</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">  </span><span class="c">!! Creates reshape plan</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">  </span><span class="c">!! This function initializes the reshape plan by creating communicators for brick layouts,</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">  </span><span class="c">!! setting up grid decompositions, and allocating reshape operation plans.</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">reshape_plan</span><span class="p">),</span><span class="w">            </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">self</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">      </span><span class="c">!! Reshape plan to be initialized</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_platform_t</span><span class="p">),</span><span class="w">         </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">platform</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">      </span><span class="c">!! Platform to create plan for (HOST or CUDA)</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil_init</span><span class="p">),</span><span class="w">              </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">ipencil</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">      </span><span class="c">!! Pencil decomposition passed by user</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">pencils</span><span class="p">(:)</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">      </span><span class="c">!! Array of pencil decompositions for different layouts</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">                  </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">      </span><span class="c">!! Global MPI communicator</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">                  </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">local_comms</span><span class="p">(:)</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">      </span><span class="c">!! Local MPI communicators for each dimension</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">    </span><span class="n">TYPE_MPI_DATATYPE</span><span class="p">,</span><span class="w">              </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_dtype</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">      </span><span class="c">!! Base MPI datatype for complex data</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                 </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_storage</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">      </span><span class="c">!! Number of bytes needed to store single complex element</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_effort_t</span><span class="p">),</span><span class="w">           </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">effort</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">      </span><span class="c">!! dtFFT planner effort level (ESTIMATE, MEASURE, PATIENT, EXHAUSTIVE)</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w">          </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">backend</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="w">      </span><span class="c">!! Communication backend to use</span>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">    </span><span class="n">TYPE_MPI_DATATYPE</span><span class="p">,</span><span class="w">              </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_init_dtype</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">      </span><span class="c">!! Base MPI datatype for real data</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                 </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_init_storage</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">      </span><span class="c">!! Number of bytes needed to store single real element</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">bricks</span><span class="p">(:)</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">      </span><span class="c">!! Pencils describing brick data distribution</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w">                        </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">is_final_enabled</span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">      </span><span class="c">!! Flag indicating if final reshape in Fourier space is enabled</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w">                                </span><span class="kd">::</span><span class="w"> </span><span class="n">error_code</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">      </span><span class="c">!! Error code: DTFFT_SUCCESS on success</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">ndims</span><span class="w">      </span><span class="c">!! Number of dimensions</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">c_size</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">bsize</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">temp_comms</span><span class="p">(:)</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">min_buffer_size_real</span><span class="p">,</span><span class="w"> </span><span class="n">min_buffer_size_complex</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="n">te</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">    </span><span class="n">error_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DTFFT_SUCCESS</span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">    </span><span class="n">CHECK_CALL</span><span class="p">(</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">effort</span><span class="p">),</span><span class="w"> </span><span class="n">error_code</span><span class="w"> </span><span class="p">)</span>
<a id="ln-154" name="ln-154" href="#ln-154"></a>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">    </span><span class="n">ndims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">ipencil</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="w"> </span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">)</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">    </span><span class="k">call </span><span class="n">bricks</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">create</span><span class="p">(</span><span class="n">ndims</span><span class="p">,</span><span class="w"> </span><span class="mi">1_int8</span><span class="p">,</span><span class="w"> </span><span class="n">ipencil</span><span class="p">%</span><span class="n">dims</span><span class="p">,</span><span class="w"> </span><span class="n">ipencil</span><span class="p">%</span><span class="n">comms</span><span class="p">,</span><span class="w"> </span><span class="n">lstarts</span><span class="o">=</span><span class="n">ipencil</span><span class="p">%</span><span class="n">starts</span><span class="p">,</span><span class="w"> </span><span class="n">lcounts</span><span class="o">=</span><span class="n">ipencil</span><span class="p">%</span><span class="n">counts</span><span class="p">)</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">ipencil</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">c_size</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">init_grid</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">    </span><span class="k">do </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ndims</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">      </span><span class="k">call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">ipencil</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">init_grid</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="k">    allocate</span><span class="p">(</span><span class="w"> </span><span class="n">temp_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_dup</span><span class="p">(</span><span class="n">ipencil</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">    </span><span class="k">call </span><span class="n">create_custom_comm</span><span class="p">(</span><span class="n">local_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">c_size</span><span class="p">,</span><span class="w"> </span><span class="n">NEIGHBOR_GROUP</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">    </span><span class="k">call </span><span class="n">create_custom_comm</span><span class="p">(</span><span class="n">local_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">c_size</span><span class="p">,</span><span class="w"> </span><span class="n">STRIDED_GROUP</span><span class="p">,</span><span class="w"> </span><span class="n">temp_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">))</span>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndims</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="k">      </span><span class="n">temp_comms</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_comms</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="k">    call </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="n">local_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">c_size</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">bsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">    </span><span class="k">block</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="k">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">slow_count</span><span class="p">,</span><span class="w"> </span><span class="n">min_start</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">      </span><span class="n">TYPE_MPI_COMM</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">final_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">      </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">final_sizes</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">      </span><span class="k">call </span><span class="n">MPI_Allreduce</span><span class="p">(</span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)%</span><span class="n">counts</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">slow_count</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">      </span><span class="n">final_comms</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">      </span><span class="n">final_sizes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipencil</span><span class="p">%</span><span class="n">dims</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndims</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="k">        </span><span class="n">final_comms</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_COMM_SELF</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="w">        </span><span class="n">final_sizes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slow_count</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">      </span><span class="k">else  </span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="k">        </span><span class="n">final_comms</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_COMM_SELF</span>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">        </span><span class="n">final_comms</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_COMM_SELF</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">        </span><span class="n">final_sizes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)%</span><span class="n">counts</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">        </span><span class="n">final_sizes</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slow_count</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">      </span><span class="k">endif</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="k">      call </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">create</span><span class="p">(</span><span class="n">ndims</span><span class="p">,</span><span class="w"> </span><span class="n">ndims</span><span class="p">,</span><span class="w"> </span><span class="n">final_sizes</span><span class="p">,</span><span class="w"> </span><span class="n">final_comms</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)%</span><span class="n">starts</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)%</span><span class="n">counts</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a id="ln-198" name="ln-198" href="#ln-198"></a>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">      </span><span class="k">call </span><span class="n">MPI_Allreduce</span><span class="p">(</span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)%</span><span class="n">starts</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">min_start</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_MIN</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">      </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">starts</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">starts</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">min_start</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndims</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="k">        </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">starts</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)%</span><span class="n">starts</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">      </span><span class="k">endif</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="k">    end block</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="k">    </span><span class="n">temp_comms</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">temp_comms</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">temp_comms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ndims</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="k">      call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">temp_comms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="k">    </span><span class="n">is_final_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">final_grid</span><span class="p">(</span><span class="n">ndims</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">get_conf_fourier_reshape_enabled</span><span class="p">()</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">is_final_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_free</span><span class="p">(</span><span class="n">temp_comms</span><span class="p">(</span><span class="n">ndims</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">    </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">temp_comms</span><span class="w"> </span><span class="p">)</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">    </span><span class="n">self</span><span class="p">%</span><span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_conf_reshape_backend</span><span class="p">()</span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">is_backend_compatible</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">backend</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">effort</span><span class="p">%</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">DTFFT_PATIENT</span><span class="p">%</span><span class="n">val</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="k">      </span><span class="n">WRITE_WARN</span><span class="p">(</span><span class="s2">&quot;Incompatible reshape backend detected, it has been ignored&quot;</span><span class="p">)</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">      </span><span class="n">self</span><span class="p">%</span><span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_compatible</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">)</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="k">    call </span><span class="n">get_local_sizes</span><span class="p">([</span><span class="n">bricks</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span><span class="w"> </span><span class="n">alloc_size</span><span class="o">=</span><span class="n">min_buffer_size_real</span><span class="p">)</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">    </span><span class="k">call </span><span class="n">get_local_sizes</span><span class="p">([</span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)],</span><span class="w"> </span><span class="n">alloc_size</span><span class="o">=</span><span class="n">min_buffer_size_complex</span><span class="p">)</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="w">    </span><span class="n">min_buffer_size_real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_buffer_size_real</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">base_init_storage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">FLOAT_STORAGE_SIZE</span><span class="p">)</span>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">    </span><span class="n">min_buffer_size_complex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_buffer_size_complex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">base_storage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">FLOAT_STORAGE_SIZE</span><span class="p">)</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">    </span><span class="n">self</span><span class="p">%</span><span class="n">min_buffer_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">min_buffer_size_real</span><span class="p">,</span><span class="w"> </span><span class="n">min_buffer_size_complex</span><span class="p">)</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">effort</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_EXHAUSTIVE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="k">      </span><span class="n">ts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_Wtime</span><span class="p">()</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="w">  </span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">      </span><span class="n">PHASE_BEGIN</span><span class="p">(</span><span class="s2">&quot;Autotune reshape plan&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">COLOR_AUTOTUNE</span><span class="p">)</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">      </span><span class="n">WRITE_INFO</span><span class="p">(</span><span class="s2">&quot;Starting autotune of reshape plans...&quot;</span><span class="p">)</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">      </span><span class="k">call </span><span class="n">autotune_reshape_plan</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="n">base_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">        </span><span class="n">bricks</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">min_buffer_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">FLOAT_STORAGE_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">backend</span><span class="p">)</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="w">      </span><span class="n">PHASE_END</span><span class="p">(</span><span class="s2">&quot;Autotune reshape plan&quot;</span><span class="p">)</span>
<a id="ln-241" name="ln-241" href="#ln-241"></a>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">      </span><span class="n">te</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_Wtime</span><span class="p">()</span>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">      </span><span class="n">WRITE_INFO</span><span class="p">(</span><span class="s2">&quot;Time spent on autotune: &quot;</span><span class="o">//</span><span class="n">to_str</span><span class="p">(</span><span class="n">te</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ts</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; [s]&quot;</span><span class="p">)</span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="k">    </span><span class="n">ts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_Wtime</span><span class="p">()</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">    </span><span class="k">call </span><span class="n">self</span><span class="p">%</span><span class="n">helper</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">comms</span><span class="p">,</span><span class="w"> </span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">backend</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="n">bricks</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">ndims</span><span class="p">)])</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">    </span><span class="k">call </span><span class="n">create_reshape_plans</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">plans</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">helper</span><span class="p">,</span><span class="w"> </span><span class="n">effort</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="w">         </span><span class="n">base_init_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="n">base_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_storage</span><span class="p">,</span><span class="w"> </span><span class="n">bricks</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">)</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">    </span><span class="n">te</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_Wtime</span><span class="p">()</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">    </span><span class="n">WRITE_INFO</span><span class="p">(</span><span class="s2">&quot;Time spent on creating final reshape plans: &quot;</span><span class="o">//</span><span class="n">to_str</span><span class="p">(</span><span class="n">te</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ts</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; [s]&quot;</span><span class="p">)</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a>
<a id="ln-254" name="ln-254" href="#ln-254"></a>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">self</span><span class="p">%</span><span class="n">names</span><span class="p">(</span><span class="n">CONF_DTFFT_RESHAPE_X_BRICKS_TO_PENCILS</span><span class="p">:</span><span class="n">CONF_DTFFT_RESHAPE_Z_BRICKS_TO_PENCILS</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">    </span><span class="k">do </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONF_DTFFT_RESHAPE_X_BRICKS_TO_PENCILS</span><span class="p">,</span><span class="w"> </span><span class="n">CONF_DTFFT_RESHAPE_Z_BRICKS_TO_PENCILS</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">      </span><span class="n">self</span><span class="p">%</span><span class="n">names</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="n">RESHAPE_NAMES</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">    </span><span class="k">end do</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="k">  end function </span><span class="n">create</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">create_custom_comm</span><span class="p">(</span><span class="n">old_comm</span><span class="p">,</span><span class="w"> </span><span class="n">new_size</span><span class="p">,</span><span class="w"> </span><span class="n">group_type</span><span class="p">,</span><span class="w"> </span><span class="n">new_comm</span><span class="p">)</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">  </span><span class="c">!! Creates custom MPI communicator by splitting processes into groups</span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">  </span><span class="c">!! This subroutine divides processes from an existing communicator into groups</span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">  </span><span class="c">!! based on the specified group type: neighbor groups or strided groups.</span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">  </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">old_comm</span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">      </span><span class="c">!! Original MPI communicator to split</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">new_size</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="w">      </span><span class="c">!! Size of each group in the new communicator</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">group_type</span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="w">      </span><span class="c">!! Type of grouping: NEIGHBOR_GROUP (consecutive ranks) or STRIDED_GROUP (interleaved ranks)</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">  </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">new_comm</span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">      </span><span class="c">!! Newly created MPI communicator</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ierror</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">old_rank</span><span class="p">,</span><span class="w"> </span><span class="n">old_size</span><span class="p">,</span><span class="w"> </span><span class="n">color</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="n">old_comm</span><span class="p">,</span><span class="w"> </span><span class="n">old_rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierror</span><span class="p">)</span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">old_comm</span><span class="p">,</span><span class="w"> </span><span class="n">old_size</span><span class="p">,</span><span class="w"> </span><span class="n">ierror</span><span class="p">)</span>
<a id="ln-279" name="ln-279" href="#ln-279"></a>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">    </span><span class="k">select case</span><span class="p">(</span><span class="n">group_type</span><span class="p">)</span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="n">NEIGHBOR_GROUP</span><span class="p">)</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">old_rank</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">new_size</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="n">STRIDED_GROUP</span><span class="p">)</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="w">      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">mod</span><span class="p">(</span><span class="n">old_rank</span><span class="p">,</span><span class="w"> </span><span class="n">new_size</span><span class="p">)</span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">    </span><span class="k">end select</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="k">    call </span><span class="n">MPI_Comm_split</span><span class="p">(</span><span class="n">old_comm</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">,</span><span class="w"> </span><span class="n">old_rank</span><span class="p">,</span><span class="w"> </span><span class="n">new_comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierror</span><span class="p">)</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">create_custom_comm</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">  </span><span class="k">pure </span><span class="kt">logical </span><span class="k">function </span><span class="n">is_backend_compatible</span><span class="p">(</span><span class="n">backend1</span><span class="p">,</span><span class="w"> </span><span class="n">backend2</span><span class="p">)</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">  </span><span class="c">!! Checks if two communication backends are compatible</span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">  </span><span class="c">!! Backends are compatible if they belong to the same family:</span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">  </span><span class="c">!! MPI backends are compatible with each other, NCCL with NCCL, NVSHMEM with NVSHMEM.</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">  </span><span class="c">!! @return .true. if backends are compatible, .false. otherwise</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">backend1</span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">      </span><span class="c">!! First backend to compare</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">backend2</span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="w">      </span><span class="c">!! Second backend to compare</span>
<a id="ln-300" name="ln-300" href="#ln-300"></a>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">    </span><span class="n">is_backend_compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_mpi</span><span class="p">(</span><span class="n">backend1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">is_backend_mpi</span><span class="p">(</span><span class="n">backend2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">backend1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">backend2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nvshmem</span><span class="p">(</span><span class="n">backend1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">is_backend_nvshmem</span><span class="p">(</span><span class="n">backend2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a><span class="k">    </span><span class="n">is_backend_compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">  </span><span class="k">end function </span><span class="n">is_backend_compatible</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">  </span><span class="k">pure type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">get_compatible</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">)</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">  </span><span class="c">!! Returns a compatible reshape backend for the given main backend and platform</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">  </span><span class="c">!! Selects an appropriate reshape backend based on the main backend family:</span>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">  </span><span class="c">!! - For MPI backends: returns MPI_P2P (GPU) or MPI_DATATYPE (CPU)</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">  </span><span class="c">!! - For NCCL backends: returns NCCL</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">  </span><span class="c">!! - For NVSHMEM backends: returns CUFFTMP</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="w">  </span><span class="c">!! @return Compatible backend for reshape operations</span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w">  </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">backend</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">      </span><span class="c">!! Input backend from main FFT plan</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_platform_t</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">platform</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">      </span><span class="c">!! Execution platform (HOST or CUDA)</span>
<a id="ln-321" name="ln-321" href="#ln-321"></a>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_mpi</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_PLATFORM_CUDA</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="k">        </span><span class="n">get_compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DTFFT_BACKEND_MPI_P2P</span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">      </span><span class="k">else</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="k">        </span><span class="n">get_compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DTFFT_BACKEND_MPI_DATATYPE</span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">      </span><span class="k">endif</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="k">    else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="k">      </span><span class="n">get_compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DTFFT_BACKEND_NCCL</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="w">    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nvshmem</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="k">      </span><span class="n">get_compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DTFFT_BACKEND_CUFFTMP</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="w">    </span><span class="k">endif</span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="k">  end function </span><span class="n">get_compatible</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">create_reshape_plans</span><span class="p">(</span><span class="n">plans</span><span class="p">,</span><span class="w"> </span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">helper</span><span class="p">,</span><span class="w"> </span><span class="n">effort</span><span class="p">,</span><span class="w"> </span><span class="n">force_effort</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="n">base_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_storage</span><span class="p">,</span><span class="w"> </span><span class="n">bricks</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">)</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">  </span><span class="c">!! Creates and allocates all reshape operation plans</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="w">  </span><span class="c">!!</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">  </span><span class="c">!! This subroutine allocates and initializes plans for all four reshape operations:</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="w">  </span><span class="c">!! - X_BRICKS_TO_PENCILS: brick to pencil in X dimension (real space)</span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="w">  </span><span class="c">!! - X_PENCILS_TO_BRICKS: pencil to brick in X dimension (real space)</span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">  </span><span class="c">!! - Z_PENCILS_TO_BRICKS: pencil to brick in Z dimension (Fourier space)</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">  </span><span class="c">!! - Z_BRICKS_TO_PENCILS: brick to pencil in Z dimension (Fourier space)</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">reshape_container</span><span class="p">),</span><span class="w">  </span><span class="k">allocatable</span><span class="p">,</span><span class="w">  </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plans</span><span class="p">(:)</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">      </span><span class="c">!! Array of reshape plan containers to be allocated and initialized</span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w">                  </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">backend</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="w">      </span><span class="c">!! Communication backend to use for reshape operations</span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_platform_t</span><span class="p">),</span><span class="w">                 </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">platform</span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">      </span><span class="c">!! Execution platform (HOST or CUDA)</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">backend_helper</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">helper</span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">      </span><span class="c">!! Backend helper for communication setup</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_effort_t</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">effort</span>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">      </span><span class="c">!! dtFFT planner effort level</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w">                                </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">force_effort</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">      </span><span class="c">!! </span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="w">    </span><span class="n">TYPE_MPI_DATATYPE</span><span class="p">,</span><span class="w">                      </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_init_dtype</span>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">      </span><span class="c">!! Base MPI datatype for real space data</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                         </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_init_storage</span>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="w">      </span><span class="c">!! Number of bytes needed to store single real element</span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">    </span><span class="n">TYPE_MPI_DATATYPE</span><span class="p">,</span><span class="w">                      </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_dtype</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">      </span><span class="c">!! Base MPI datatype for Fourier space data</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                         </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_storage</span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">      </span><span class="c">!! Number of bytes needed to store single complex element</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil</span><span class="p">),</span><span class="w">                           </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">bricks</span><span class="p">(:)</span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">      </span><span class="c">!! Pencils describing brick data distribution</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil</span><span class="p">),</span><span class="w">                           </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">pencils</span><span class="p">(:)</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="w">      </span><span class="c">!! Array of pencil decompositions</span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">     </span><span class="k">type</span><span class="p">(</span><span class="n">create_args</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">args</span>
<a id="ln-368" name="ln-368" href="#ln-368"></a>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">plans</span><span class="p">(</span><span class="n">CONF_DTFFT_RESHAPE_X_BRICKS_TO_PENCILS</span><span class="p">:</span><span class="n">CONF_DTFFT_RESHAPE_Z_BRICKS_TO_PENCILS</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="w">    </span><span class="k">call </span><span class="n">allocate_plans</span><span class="p">(</span><span class="n">plans</span><span class="p">,</span><span class="w"> </span><span class="n">backend</span><span class="p">)</span>
<a id="ln-372" name="ln-372" href="#ln-372"></a>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">platform</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">helper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">helper</span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">effort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effort</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backend</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">force_effort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">force_effort</span>
<a id="ln-378" name="ln-378" href="#ln-378"></a>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">base_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_init_dtype</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">base_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_init_storage</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a><span class="w">    </span><span class="k">call </span><span class="n">plans</span><span class="p">(</span><span class="n">CONF_DTFFT_RESHAPE_X_BRICKS_TO_PENCILS</span><span class="p">)%</span><span class="n">p</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">bricks</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="k">call </span><span class="n">plans</span><span class="p">(</span><span class="n">CONF_DTFFT_RESHAPE_X_PENCILS_TO_BRICKS</span><span class="p">)%</span><span class="n">p</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">pencils</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">bricks</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">base_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_dtype</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="w">    </span><span class="n">args</span><span class="p">%</span><span class="n">base_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base_storage</span>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="w">    </span><span class="k">call </span><span class="n">plans</span><span class="p">(</span><span class="n">CONF_DTFFT_RESHAPE_Z_PENCILS_TO_BRICKS</span><span class="p">)%</span><span class="n">p</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">pencils</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pencils</span><span class="p">)),</span><span class="w"> </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="w">    </span><span class="k">call </span><span class="n">plans</span><span class="p">(</span><span class="n">CONF_DTFFT_RESHAPE_Z_BRICKS_TO_PENCILS</span><span class="p">)%</span><span class="n">p</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pencils</span><span class="p">)),</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">create_reshape_plans</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">autotune_reshape_plan</span><span class="p">(</span><span class="w">                                                                </span><span class="p">&amp;</span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">    </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">base_comm</span><span class="p">,</span><span class="w"> </span><span class="n">comms</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="n">base_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_storage</span><span class="p">,</span><span class="w"> </span><span class="n">bricks</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">    </span><span class="n">buffer_size</span><span class="p">,</span><span class="w"> </span><span class="n">transpose_backend</span><span class="p">,</span><span class="w"> </span><span class="n">best_backend</span><span class="p">)</span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">  </span><span class="c">!! Runs autotune for all backends</span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_platform_t</span><span class="p">),</span><span class="w">           </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">platform</span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">      </span><span class="c">!! Platform to create plan for</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">                    </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_comm</span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">      </span><span class="c">!! 3D Cartesian comm</span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">    </span><span class="n">TYPE_MPI_COMM</span><span class="p">,</span><span class="w">                    </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">comms</span><span class="p">(:)</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">      </span><span class="c">!! 1D comms</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a><span class="w">    </span><span class="n">TYPE_MPI_DATATYPE</span><span class="p">,</span><span class="w">                </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_init_dtype</span>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">      </span><span class="c">!! Base MPI datatype for real space data</span>
<a id="ln-402" name="ln-402" href="#ln-402"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_init_storage</span>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">      </span><span class="c">!! Number of bytes needed to store single real element</span>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="w">    </span><span class="n">TYPE_MPI_DATATYPE</span><span class="p">,</span><span class="w">                </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_dtype</span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">      </span><span class="c">!! Base MPI datatype for Fourier space data</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">base_storage</span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">      </span><span class="c">!! Number of bytes needed to store single complex element</span>
<a id="ln-408" name="ln-408" href="#ln-408"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil</span><span class="p">),</span><span class="w">                     </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">bricks</span><span class="p">(:)</span>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">      </span><span class="c">!! Pencils describing brick data distribution</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">pencil</span><span class="p">),</span><span class="w">                     </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">pencils</span><span class="p">(:)</span>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="w">      </span><span class="c">!! Array of pencil decompositions</span>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_stream_t</span><span class="p">),</span><span class="w">             </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">stream</span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">      </span><span class="c">!! Stream to use</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span><span class="w">                   </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">buffer_size</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">      </span><span class="c">!! Size of the buffer to use during autotune (in bytes)</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w">            </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">transpose_backend</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="w">      </span><span class="c">!! Backend used in transpose plans</span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w">            </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">best_backend</span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">      </span><span class="c">!! Best backend selected</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">),</span><span class="w">  </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">backends_to_run</span><span class="p">(:)</span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">dtfft_backend_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">current_backend_id</span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">execution_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time_</span>
<a id="ln-423" name="ln-423" href="#ln-423"></a><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">b</span>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">reshape_container</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">plans</span><span class="p">(:)</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="cp">#ifdef DTFFT_WITH_CUDA</span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nccl_enabled</span><span class="p">,</span><span class="w"> </span><span class="n">nvshmem_enabled</span>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="cp">#endif</span>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">testing_phase</span>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">backend_helper</span><span class="p">)</span><span class="w">                      </span><span class="kd">::</span><span class="w"> </span><span class="n">helper</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pipe_enabled</span><span class="p">,</span><span class="w"> </span><span class="n">mpi_enabled</span><span class="p">,</span><span class="w"> </span><span class="n">dtype_enabled</span>
<a id="ln-431" name="ln-431" href="#ln-431"></a>
<a id="ln-432" name="ln-432" href="#ln-432"></a><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">backends_to_run</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="o">=</span><span class="n">VALID_BACKENDS</span><span class="w"> </span><span class="p">)</span>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="w">    </span><span class="k">call </span><span class="n">helper</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">base_comm</span><span class="p">,</span><span class="w"> </span><span class="n">comms</span><span class="p">,</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">backends_to_run</span><span class="p">)),</span><span class="w"> </span><span class="p">[</span><span class="n">bricks</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">bricks</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">pencils</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pencils</span><span class="p">))])</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="w">    </span><span class="n">pipe_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_conf_pipelined_enabled</span><span class="p">()</span>
<a id="ln-436" name="ln-436" href="#ln-436"></a><span class="w">    </span><span class="n">dtype_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_conf_datatype_enabled</span><span class="p">()</span>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="w">    </span><span class="n">mpi_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_conf_mpi_enabled</span><span class="p">()</span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="cp">#ifdef DTFFT_WITH_CUDA</span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">    </span><span class="n">nccl_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_conf_nccl_enabled</span><span class="p">()</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a><span class="w">    </span><span class="n">nvshmem_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_conf_nvshmem_enabled</span><span class="p">()</span>
<a id="ln-441" name="ln-441" href="#ln-441"></a><span class="cp">#endif</span>
<a id="ln-442" name="ln-442" href="#ln-442"></a>
<a id="ln-443" name="ln-443" href="#ln-443"></a><span class="w">    </span><span class="n">best_time_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAX_REAL32</span>
<a id="ln-444" name="ln-444" href="#ln-444"></a>
<a id="ln-445" name="ln-445" href="#ln-445"></a><span class="w">    </span><span class="k">do </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">backends_to_run</span><span class="p">)</span>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="w">      </span><span class="n">current_backend_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">backends_to_run</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<a id="ln-447" name="ln-447" href="#ln-447"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">is_backend_compatible</span><span class="p">(</span><span class="n">transpose_backend</span><span class="p">,</span><span class="w"> </span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-448" name="ln-448" href="#ln-448"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">current_backend_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_BACKEND_MPI_DATATYPE</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_PLATFORM_CUDA</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-449" name="ln-449" href="#ln-449"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_pipelined</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">pipe_enabled</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-450" name="ln-450" href="#ln-450"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_mpi</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">mpi_enabled</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">current_backend_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_BACKEND_MPI_DATATYPE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-451" name="ln-451" href="#ln-451"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">current_backend_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_BACKEND_MPI_DATATYPE</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">dtype_enabled</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-452" name="ln-452" href="#ln-452"></a><span class="cp">#ifdef DTFFT_WITH_CUDA</span>
<a id="ln-453" name="ln-453" href="#ln-453"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_PLATFORM_CUDA</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-454" name="ln-454" href="#ln-454"></a><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nvshmem</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">nvshmem_enabled</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-455" name="ln-455" href="#ln-455"></a><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">nccl_enabled</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-456" name="ln-456" href="#ln-456"></a><span class="w">        </span><span class="c">! DTFFT_BACKEND_CUFFTMP == DTFFT_BACKEND_CUFFTMP_PIPELINED for this plan</span>
<a id="ln-457" name="ln-457" href="#ln-457"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">current_backend_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DTFFT_BACKEND_CUFFTMP_PIPELINED</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-458" name="ln-458" href="#ln-458"></a><span class="k">      else</span>
<a id="ln-459" name="ln-459" href="#ln-459"></a><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_backend_nccl</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">is_backend_nvshmem</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<a id="ln-460" name="ln-460" href="#ln-460"></a><span class="k">      endif</span>
<a id="ln-461" name="ln-461" href="#ln-461"></a><span class="cp">#endif</span>
<a id="ln-462" name="ln-462" href="#ln-462"></a>
<a id="ln-463" name="ln-463" href="#ln-463"></a><span class="w">      </span><span class="n">testing_phase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Testing backend &quot;</span><span class="o">//</span><span class="n">dtfft_get_backend_string</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">)</span>
<a id="ln-464" name="ln-464" href="#ln-464"></a><span class="w">      </span><span class="n">REGION_BEGIN</span><span class="p">(</span><span class="n">testing_phase</span><span class="p">,</span><span class="w"> </span><span class="n">COLOR_AUTOTUNE2</span><span class="p">)</span>
<a id="ln-465" name="ln-465" href="#ln-465"></a><span class="w">      </span><span class="n">WRITE_INFO</span><span class="p">(</span><span class="n">testing_phase</span><span class="p">)</span>
<a id="ln-466" name="ln-466" href="#ln-466"></a>
<a id="ln-467" name="ln-467" href="#ln-467"></a><span class="w">      </span><span class="k">call </span><span class="n">create_reshape_plans</span><span class="p">(</span><span class="n">plans</span><span class="p">,</span><span class="w"> </span><span class="n">current_backend_id</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">helper</span><span class="p">,</span><span class="w"> </span><span class="n">DTFFT_ESTIMATE</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="n">base_init_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_init_storage</span><span class="p">,</span><span class="w"> </span><span class="n">base_dtype</span><span class="p">,</span><span class="w"> </span><span class="n">base_storage</span><span class="p">,</span><span class="w"> </span><span class="n">bricks</span><span class="p">,</span><span class="w"> </span><span class="n">pencils</span><span class="p">)</span>
<a id="ln-468" name="ln-468" href="#ln-468"></a>
<a id="ln-469" name="ln-469" href="#ln-469"></a><span class="w">      </span><span class="n">execution_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">execute_autotune</span><span class="p">(</span><span class="n">plans</span><span class="p">,</span><span class="w"> </span><span class="n">base_comm</span><span class="p">,</span><span class="w"> </span><span class="n">current_backend_id</span><span class="p">,</span><span class="w"> </span><span class="n">platform</span><span class="p">,</span><span class="w"> </span><span class="n">helper</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_size</span><span class="p">)</span>
<a id="ln-470" name="ln-470" href="#ln-470"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">execution_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">best_time_</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-471" name="ln-471" href="#ln-471"></a><span class="k">        </span><span class="n">best_time_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">execution_time</span>
<a id="ln-472" name="ln-472" href="#ln-472"></a><span class="w">        </span><span class="n">best_backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_backend_id</span>
<a id="ln-473" name="ln-473" href="#ln-473"></a><span class="w">      </span><span class="k">endif</span>
<a id="ln-474" name="ln-474" href="#ln-474"></a><span class="k">      call </span><span class="n">destroy_plans</span><span class="p">(</span><span class="n">plans</span><span class="p">)</span>
<a id="ln-475" name="ln-475" href="#ln-475"></a><span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="w"> </span><span class="n">plans</span><span class="w"> </span><span class="p">)</span>
<a id="ln-476" name="ln-476" href="#ln-476"></a><span class="w">      </span><span class="n">REGION_END</span><span class="p">(</span><span class="s2">&quot;Testing backend &quot;</span><span class="o">//</span><span class="n">dtfft_get_backend_string</span><span class="p">(</span><span class="n">current_backend_id</span><span class="p">))</span>
<a id="ln-477" name="ln-477" href="#ln-477"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-478" name="ln-478" href="#ln-478"></a>
<a id="ln-479" name="ln-479" href="#ln-479"></a><span class="k">    call </span><span class="n">helper</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>
<a id="ln-480" name="ln-480" href="#ln-480"></a>
<a id="ln-481" name="ln-481" href="#ln-481"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">autotune_reshape_plan</span>
<a id="ln-482" name="ln-482" href="#ln-482"></a><span class="k">end module </span><span class="n">dtfft_reshape_plan</span>
</pre></div>

      </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              dtFFT
 was developed by Oleg Shatrov<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>