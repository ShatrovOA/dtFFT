#define CHECK_INPUT(param_name, param_value, valid_values) \
  if(.not.any(param_value == valid_values)) FATAL_ERROR("Wrong parameter `"//trim(param_name)//"` passed")

#define CHECK_PLAN \
  if(.not. self%is_created) FATAL_ERROR("Plan has not been created")
